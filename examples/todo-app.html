<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>TODO APP</title>
  </head>
  <body>
    <div id="todo-app"></div>
    <hr>
    <div id="todo-app2"></div>
    <script type="text/javascript" src="../bin/wet.js"></script>

    <style media="screen">
    .done {
      text-decoration: line-through;
    }
    </style>

    <script type="text/template" id="todo-app-tpl">
      <div>
        <h1>{name}</h1>
        <input type="text"
          w-model="newTodo"
          w-on="keydown: handleKeyDown">
        <button w-on="click: addTodo(newTodo)">#Add</button>
        <ul>
          <li w-repeat="todos" w-on="click: go">
            <div w-class="done: done">
              #{$index}: {content}
              <input type="checkbox" w-model="done">
              <button type="button" w-on="click: deleteTodo($index)">x</button>
            </div>
          </li>
        </ul>
      </div>
    </script>
  </body>

  <script type="text/javascript">

  var tpl = document.getElementById("todo-app-tpl").innerHTML
  var TodoApp = Wet.component("TodoApp", {
    template: tpl,
    addTodo: function(content) {
      if (!content) return
      this.updateArray("todos").push({
        content: content,
        done: false
      })
      this.update({
        newTodo: ""
      })
    },
    go: function() {
      console.log('fuck');
    },
    handleKeyDown: function(event) {
      if (event.keyCode === 13) {
        this.addTodo(this.state.newTodo)
      }
    },
    deleteTodo: function(index) {
      this.updateArray("todos").splice(index, 1)
    }
  })

  var todoApp = new TodoApp({
    state: {
      name: "Todo App 1",
      newTodo: "",
      todos: [
        {content: "Take a showser", done: false},
        {content: "Wash clothes", done: false},
        {content: "Play with the cats", done: false},
        {content: "Go to bedroom", done: false}
      ]
    }
  })

  var todoApp2 = new TodoApp({
    state: {
      name: "Todo App2",
      newTodo: "",
      todos: [
        {content: "Take a showser2", done: false},
        {content: "Wash clothes", done: false},
        {content: "Play with the cats", done: false},
        {content: "Go to bedroom", done: false}
      ]
    }
  })

  Wet.render(document.getElementById("todo-app"), todoApp)
  Wet.render(document.getElementById("todo-app2"), todoApp2)
  </script>
</html>
