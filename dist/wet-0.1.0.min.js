!function t(e,n,r){function o(a,c){if(!n[a]){if(!e[a]){var s="function"==typeof require&&require;if(!c&&s)return s(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){var n=e[a][1][t];return o(n?n:t)},u,u.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,n){function r(t,e,n){this.arr=t,this.scope=n,this.path=e}var o=t("./object-path"),i=t("./util"),a=r.prototype;i.each(["replace","pop","push","shift","unshift","splice","sort","reverse"],function(t){a[t]=function(){var e=this.arr[t].apply(this.arr,arguments);return this.scope.$root.broadcast(o.makeArrayEvent(t,this.path),arguments),e}}),e.exports=r},{"./object-path":17,"./util":21}],2:[function(t,e,n){function r(t,e,n){s.each(t,function(t){s.each(t.paths,function(t){e.scope.watch(t,n)})})}function o(t){if(s.isString(t))return u.parseTokensAndPaths(t);var e="";for(key in t)e+=t[key];return u.parseTokensAndPaths(e)}function i(t){var e=new RegExp("^"+c.directivePrefix+"-([\\w\\d]+)"),n=t.name.match(e);return n?n[1]:void 0}function a(t){for(var e=["component","repeat","on"],n=0,r=e.length;r>n;n++)if(e[n]===t)return!0;return!1}var c=t("./config"),s=t("./util"),u=t("./parser"),h=t("./directives");n.bindText=function(t,e){function n(){var n=o;s.each(i,function(t){var r=u.exec(t,e.scope);n=n.replace(t.rawExp,r)}),t.nodeValue?t.nodeValue=n:t.textNode=n}var o=t.textContent||t.nodeValue,i=u.parse(o);n(),r(i,e,n)},n.bindDir=function(t,e,n){var r=i(t);if(r&&"ignore"!==r){if(!h[r])throw new Error("directive `"+r+"` is not found.");var c=u.parseDirective(t.value),p=o(c).paths,f=h[r];f.bind(e,t,n,c),a(r)||s.each(p,function(r){n.scope.watch(r,function(){f.update(e,t,n,c)})})}},n.getTokensAndPathsFromDirective=o},{"./config":6,"./directives":9,"./parser":18,"./util":21}],3:[function(t,e,n){n.components={}},{}],4:[function(t,e,n){function r(t,e){if(t||a.error("Parse error. There maybe somethin wrong with the template."),1===t.nodeType){o(t,e);var n=s(t),u=h+"-ignore";if(n.attr(u))return void n.removeAttr(u);var p=i(t.childNodes);a.each(p,function(t){r(t,e)})}else 3===t.nodeType&&c.bindText(t,e)}function o(t,e){var n=t.attributes;a.each(n,function(n){c.bindDir(n,t,e)})}function i(t){var e=[];return a.each(t,function(t){e.push(t)}),e}var a=t("./util"),c=t("./binder"),s=t("./dom"),u=t("./config"),h=u.directivePrefix;n.compile=r},{"./binder":2,"./config":6,"./dom":14,"./util":21}],5:[function(t,e,n){var r=t("./util"),o=t("./compiler"),i=(t("./object-path"),t("./parser"),t("./dom")),a=t("./event-emitter"),c=t("./scope"),s=t("./common"),u=t("./register"),h=(s.components,{init:function(t,e,n){e=e||r.extend(!0,{},p),this.el=t.el||i.getDOMNodeFromTemplate(n.template),this.state=t.state,this.parent=e.parent;var a=e.parent.scope;this.scope=new c(e.currentPath,this.state,a),this.scope.extra=e.extra||{},this.scope.extra.$this=this,delete t.el,r.extend(this,t),o.compile(this.el,this)},update:function(t){this.scope.update(t)},updateArray:function(){return this.scope.updateArray.apply(this.scope,arguments)},callMethod:function(t,e){for(var n=this;n&&!n[t];)n=n.parent;n&&n[t]?n[t].apply(n,e):r.error("method `"+t+"` is not found.")}}),p={currentPath:"",parent:{emit:function(){},scope:{$root:null,currentPath:""}}};s.component=e.exports=function(t,e){var e=arguments.length>=2?e:t,n=function(t,n){e.notEmitter||a.call(this),this.init(t,n,e)};u(t,n);var o=n.prototype;return e.notEmitter||r.extend(o,a.prototype),r.extend(o,h),r.of(e,function(t,e){r.isFunction(e)&&(o[t]=e)}),n}},{"./common":3,"./compiler":4,"./dom":14,"./event-emitter":15,"./object-path":17,"./parser":18,"./register":19,"./scope":20,"./util":21}],6:[function(t,e,n){var r=n;r.openTag="{",r.closeTag="}",r.directivePrefix="w",r.arrayEventPrefix="$$array$$"},{}],7:[function(t,e,n){var r=t("../dom"),o=t("../parser");e.exports={bind:function(t,e,n,r){this.update(t,e,n,r)},update:function(t,e,n,i){var a=r(t);for(var c in i){var s=o.parseTokensAndPaths(i[c]),u=o.exec({exp:i[c],tokens:s.tokens,paths:s.paths},n.scope);u?a.addClass(c):a.removeClass(c)}}}},{"../dom":14,"../parser":18}],8:[function(t,e,n){var r=t("../util"),o=t("../object-path"),i=t("../common").components,a=t("../config"),c=t("../dom"),s=a.directivePrefix;e.exports={bind:function(t,e,n,a){var u=e.value.split(":"),h=r.trim(u[0]),p=u[1]?r.trim(u[1]):"$item";i[h]||r.error("Component `"+h+"` is not found.");var f=i[h],l=n.scope.getObjectByPath(p),m="$item"===p?"":p,v=new f({state:l},{parent:n,currentPath:o.join([n.scope.currentPath,m])});c(t).attr(s+"-ignore","true"),t.innerHTML="",t.appendChild(v.el)}}},{"../common":3,"../config":6,"../dom":14,"../object-path":17,"../util":21}],9:[function(t,e,n){t("../dom");n.show=t("./show"),n.model=t("./model"),n["class"]=t("./class"),n.component=t("./component"),n.repeat=t("./repeat"),n.on=t("./on")},{"../dom":14,"./class":7,"./component":8,"./model":10,"./on":11,"./repeat":12,"./show":13}],10:[function(t,e,n){var r=t("../dom"),o=t("../object-path"),i={};i.text={bind:function(t,e,n,i){function a(){var e=i.replace(/\(\)/g,""),r=o.makePathFromRawPath(e),a=o.makeObjectByPath(r,t.value),c=o.getFirstProp(r),s=n.scope.getRightScopeByToken(c);s.update(a)}this.update(t,e,n,i),r(t).on("input",a),r(t).on("keyup",a)},update:function(t,e,n,r){var i=r.replace(/\(\)/g,""),a=o.makePathFromRawPath(i),c=o.getFirstProp(a),s=n.scope.getRightScopeByToken(c),u=s.getObjectByPath(a);u!==t.value&&(t.value=u)}},i.checkbox={bind:function(t,e,n,o){var i=r(t);this.update(t,e,n,o),i.on("click",function(){var e=o.replace(/\(\)/g,"");if(t.checked)var r=!0;else var r=!1;var i={};i[e]=r,n.scope.update(i)})},update:function(t,e,n,o){var i=o.replace(/\(\)/g,""),a=r(t);n.scope.state[i]?a.attr("checked","checked"):a.removeAttr("checked")}},e.exports={bind:function(t,e,n,o){var a=r(t).attr("type")||"text";"textarea"===a&&(a="text"),i[a].bind(t,e,n,o)},update:function(t,e,n,o){var a=r(t).attr("type")||"text";"textarea"===a&&(a="text"),i[a].update(t,e,n,o)}}},{"../dom":14,"../object-path":17}],11:[function(t,e,n){function r(t,e,n){if(0===t.length)return[n];var r=[];return i.each(t,function(t){r.push("$event"===t?n:e.scope.getObjectByPath(i.trim(t)))}),r}var o=t("../dom"),i=t("../util");e.exports={bind:function(t,e,n,i){var a=/([\S\s]+)(\([\S\s]+\))/,c=o(t);for(var s in i){var u=i[s].match(a),h=[];if(u){var p=u[1];u[2]&&(h=u[2].replace(/[\(\)]/g,"").split(","))}else var p=i[s];!function(t,e,o){c.on(e,function(e){var i=r(t,n,e);n.callMethod(o,i)})}(h,s,p)}}}},{"../dom":14,"../util":21}],12:[function(t,e,n){function r(t,e,n,r,o,c){var u=a(t),h=p.component({template:u,notEmitter:!0}),f=i(t,n,r,h,c[1]);return s(n,o,{Component:h,holders:c,components:f}),c}function o(t,e,n,r,o,a){var s=n.scope,p=n.scope.getScopeAndWatchPath(e.value).watchPath;s.watchArray(p,function(e,r){function p(){for(;v!==d;){var e=v.nextSibling;h(v).remove(),v=e}u.each(f.components,function(t){n.scope.removeSubScope(t.scope)});var r=i(t,n,a,f.Component,f.holders[1]);f.components=r}var f=c(n,o),m=f.holders[0],v=m.nextSibling,d=f.holders[1];switch(e){case"pop":if(d.previousSibling!==m){h(d.previousSibling).remove();var g=f.components.pop();s.removeSubScope(g.scope)}break;case"push":u.each(r,function(t,e){var r=f.components.length,o=l.join([n.scope.currentPath,a,r]),i=new f.Component({state:t},{currentPath:o,parent:n,extra:{$index:r,$item:t}});f.components.push(i),h(d).before(i.el)});break;default:p()}})}function i(t,e,n,r,o){var i=h.frag(),a=e.scope.getObjectByPath(n),c=[];return u.each(a,function(t,o){var a=new r({state:t},{currentPath:l.join([e.scope.currentPath,n,o]),parent:e,extra:{$index:o,$item:t}});c.push(a),i.appendChild(a.el)}),h(o).before(i),c}function a(t){var e=h.ele("div");return e.appendChild(t),e.innerHTML}function c(t,e){return t.scope.$root.repeatCache[e]}function s(t,e,n){var r=t.scope.$root;r.repeatCache||(r.repeatCache=[]),r.repeatCache[e]=n}var u=t("../util"),h=t("../dom"),p=t("../common"),f=t("../config"),l=(p.components,t("../object-path")),m=0,v=f.directivePrefix;e.exports={bind:function(t,e,n,i){var a=m++,c=h(t),s=document.createComment("repeat "+i+" "+a),u=document.createComment("repeat "+i+" end "+a),p=[s,u];c.before(s),c.before(u),c.remove(),c.removeAttr(e.name),r(t,e,n,i,a,p),o(t,e,n,p,a,i),c.attr(v+"-ignore","true")}}},{"../common":3,"../config":6,"../dom":14,"../object-path":17,"../util":21}],13:[function(t,e,n){var r=t("../dom");e.exports={bind:function(t,e,n){this.update(t,e,n)},update:function(t,e,n){var o=n.scope.state[e.value];r(t).css("display",o?"block":"none")}}},{"../dom":14}],14:[function(t,e,n){var r=t("./util"),o=function(t){return{el:t,hide:function(){this.el.style.display="none"},attr:function(t,e){return 1===arguments.length?this.el.getAttribute(t):void this.el.setAttribute(t,e)},removeAttr:function(t){this.el.removeAttribute(t)},css:function(t,e){1===arguments.length?this.el.style[t]:this.el.style[t]=e},on:function(t,e){var n=this.el;return n.addEventListener?n.addEventListener(t,e,!1):n.attachEvent?n.attachEvent("on"+t,e):n[t]=e,this},addClass:function(t){var e=new RegExp("(^|\\s)"+t+"(\\s|$)"),n=r.trim(this.el.className);if(!e.test(n)){var o=0===this.el.className.length?"":" ";this.el.className+=o+t}return this},removeClass:function(t){var e=this.el.className,n=new RegExp("(^|\\s)"+t+"(\\s|$)");this.el.className=r.trim(e.replace(n,"$1"))},html:function(t){return 0===arguments.length?this.el.innerHTML:void(this.el.innerHTML=t)},remove:function(t){if(!this.el.parentNode&&t){var e=this;r.nextTick(function(){e.remove(t)})}else this.el.parentNode.removeChild(this.el);return this},before:function(t,e){if(!this.el.parentNode&&e){var n=this;r.nextTick(function(){n.before(t,e)})}else this.el.parentNode.insertBefore(t,this.el);return this}}};o.getDOMNodeFromTemplate=function(t){var e=document.createElement("div");return e.innerHTML=t,e.children[0]},o.frag=function(){return document.createDocumentFragment()},o.ele=function(t){return document.createElement(t)},e.exports=o},{"./util":21}],15:[function(t,e,n){function r(){this.events={}}var o=t("./util"),i=r.prototype;i.on=function(t,e){this.events[t]?this.events[t].push(e):this.events[t]=[e]},i.emit=function(t){var e=this.events[t];if(e){var n=[].slice.call(arguments,1);o.each(e,function(t){t.apply(t,n)})}},i.off=function(t,e){var n=this.events[t];if(n)for(var r=0,o=n.length;o>r;r++)n[r]===e&&(n.splice(r,1),0===n.length&&delete this.events[t])},e.exports=r},{"./util":21}],16:[function(t,e,n){function r(t){var e=r.component(t);return new e(t)}r.component=t("./component"),r.register=t("./register"),r.render=function(t,e){t.innerHTML="",t.appendChild(e.el)},window.Wet=r},{"./component":5,"./register":19}],17:[function(t,e,n){var r=t("./util"),o=t("./config");n.getFirstProp=function(t){var e=/(^[\w_\$][\w\$_]+)([\.\[\]])?/;return t.match(e)[1]},n.makePathFromRawPath=function(t){var e=/(\[)|(\](\.)?)/g;return t.replace(e,".").replace(/\.$/,"")},n.makeStepsFromPath=function(t){var e=t.split("."),n=e[0],o=[n];return r.each(e,function(t,e){0!=e&&(n+="."+t,o.push(n))}),o},n.makePathsOfObj=function(t){function e(t,i,a){var c=n.join([a,t]);r.isObject(i)?r.of(i,function(t,n){e(t,n,c)}):o.push(c)}var o=[];return r.of(t,e),o},n.join=function(t){var e="";return r.each(t,function(t,n){r.isUndefined(t)||r.isString(t)&&0===t.length||(e=0===e.length?t:e+("."+t))}),e},n.getObjectByPath=function(t,e){var n=e.split("."),o=t;return r.each(n,function(t){o=o[t]}),o},n.makeObjectByPath=function(t,e){var o={},i=o;t=n.makePathFromRawPath(t);var a=t.split("."),c=a.length-1;return r.each(a,function(t,n){n!==c?i=i[t]={}:i[t]=e}),o},n.makeArrayEvent=function(t,e){return o.arrayEventPrefix+":"+t+":"+e}},{"./config":6,"./util":21}],18:[function(t,e,n){function r(){i=u.openTag.replace(f,"\\$1"),a=u.closeTag.replace(f,"\\$1"),c=new RegExp(i+"[\\S\\s]+?"+a,"g"),s=new RegExp(i+"|"+a,"g")}function o(t){var e=/["']/g;return t.replace(e,"")}var i,a,c,s,u=t("./config"),h=t("./util"),p=t("./object-path"),f=/(\*\.\?\+\$\^\[\]\(\)\{\}\|\\\/)/g;n.getRawExps=function(t){var e=t.match(c)||[];return e},n.getExpFromRawExp=function(t){return t.replace(s,"")};var l=/[_\w\$][_\$\w\d\.\[\]]+/g,m="Math,Date,this,true,false,null,undefined,Infinity,NaN,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,parseInt,parseFloat,in,JSON",v=new RegExp("^("+m.replace(/,/g,"\\b|")+"\\b)");n.parse=function(t){r();var e=n.getRawExps(t),o=[];return h.each(e,function(t){var e=n.getExpFromRawExp(t),r=n.parseTokensAndPaths(e),i={rawExp:t,exp:e,tokens:r.tokens,paths:r.paths};o.push(i)}),o},n.parseTokensAndPaths=function(t){var e=/('[\s\S]*?')|("[\s\S]*?")/g;t=t.replace(e,"");var n=t.match(l)||[],r={},o={},i=[],a=[];h.each(n,function(t){c=p.getFirstProp(t),v.test(c)||(r[c]=1,o[t]=1)});for(var c in r)i.push(c);for(var s in o)a.push(p.makePathFromRawPath(s));return{tokens:i,paths:a}},n.exec=function(t,e){var n=[],r=t.tokens;h.each(r,function(t){n.push(e.get(t))});var o="return "+t.exp+";";return new Function(r,o).apply(e,n)},n.parseDirective=function(t){function e(){i[h.trim(o(r))]=h.trim(c),r="",c=""}var n=/^[_$\w][_$\w\d\s\(\)\.\[\]]*$/,t=h.trim(t);if(0===t.length||n.test(t))return p.makePathFromRawPath(t);var r,i={},a=0,c="",s=t.split("");return h.each(s,function(t){switch(a){case 0:c+=t,a=1;break;case 1:":"===t?(r=c,c="",a=2):c+=t;break;case 2:","===t?(e(),a=1):"("===t?(c+=t,a=3):c+=t;break;case 3:c+=t,")"===t&&(a=4);break;case 4:","===t&&(e(),a=1)}}),e(),i},r()},{"./config":6,"./object-path":17,"./util":21}],19:[function(t,e,n){var r=t("./util"),o=t("./common").components;e.exports=function(t,e){if(r.isString(t)&&t.length>0){if(o[t])return r.error("component name "+t+" has been used.");o[t]=e,e.componentName=t}}},{"./common":3,"./util":21}],20:[function(t,e,n){function r(t,e,n){this.currentPath=t,this.state=e,this.watchPaths={},this.subScopes=[],this.parentScope=n,n&&n.$root&&t?(this.$root=n.$root,n.subScopes.push(this)):(this.$root=this,this.emitter=new a)}function o(t){return i.startsWith(t,s.arrayEventPrefix)}var i=t("./util"),a=t("./event-emitter"),c=t("./object-path"),s=t("./config"),u=t("./array-factory"),h=r.prototype;h.update=function(t){var e=this,n=c.makePathsOfObj(t);i.update(this.state,t),i.each(n,function(t){var n=e.getObjectByPath(t),r=c.join([e.currentPath,t]);i.isArray(n)&&(r=s.arrayEventPrefix+":replace:"+r),e.$root.broadcast(r)})},h.updateArray=function(t){var e=this.getObjectByPath(t);return i.isArray(e)||i.error(t+" is not an array"),new u(e,t,this)},h.watchArray=function(t,e){var n=this.getObjectByPath(t);i.isArray(n)||i.error(t+" is not an array");var r=["replace","pop","push","shift","unshift","splice","sort","reverse"],o=this;i.each(r,function(n){var r=c.makeArrayEvent(n,t),i=function(){[].unshift.call(arguments,n),e.apply(e,arguments)};o.$root.emitter.on(r,i),o.addLocalWatchPath(r,i)})},h.broadcast=function(t,e){if(!this.emitter)return i.error("I am not a root!");if(o(t)){this.$root.emitter.emit(t,e);var n=t.split(":")[2];for(var r in this.emitter.events)i.startsWith(r,n)&&r.length>n.length&&this.emitter.emit(r,e);t=n}var a=c.makeStepsFromPath(t),s=this;i.each(a,function(t){s.$root.emitter.emit(t,e)})},h.watch=function(t,e){var n=this.getScopeAndWatchPath(t),r=n.watchPath;this.addLocalWatchPath(t,e),this.$root.emitter.on(r,e)},h.addLocalWatchPath=function(t,e){var n=this.watchPaths[t];n?n.push(e):this.watchPaths[t]=[e]},h.getScopeAndWatchPath=function(t){t=c.makePathFromRawPath(t);var e=c.getFirstProp(t),n=this.getRightScopeByToken(e),r=c.join([n.currentPath,t]);return{scope:n,watchPath:r}},h.getRightScopeByToken=function(t){for(var e=this,n=!1;""!=e.currentPath&&i.isUndefined(e.state[t])&&i.isUndefined(e.extra[t]);)e=e.parentScope,n=!0;return n?e:this},h.removeSubScope=function(t){for(var e=this.subScopes,n=0,r=e.length;r>n;n++)if(e[n]===t)return t.unwatch(),e.splice(n,1)},h.unwatch=function(){var t=this.watchPaths,e=this.$root,n=this;for(var r in t)i.each(t[r],function(t){var o=c.join([n.currentPath,r]);e.emitter.off(o,t)});i.each(this.subScopes,function(t){t.unwatch()})},h.get=function(t){var e=this.getRightScopeByToken(t),n=e.state[t]||e.extra[t];return i.isUndefined(n)?"":n},h.getObjectByPath=function(t){t=c.makePathFromRawPath(t);var e=c.getFirstProp(t),n=this.getRightScopeByToken(e),r=c.getObjectByPath(n.state,t);return i.isUndefined(r)?c.getObjectByPath(n.extra,t):r},e.exports=r},{"./array-factory":1,"./config":6,"./event-emitter":15,"./object-path":17,"./util":21}],21:[function(t,e,n){function r(t,e){return!o.isUndefined(t)&&(o.isObject(t)||o.isArray(t))&&!o.isUndefined(e)&&o.isObject(e)}var o=n;o.map=function(t,e){for(var n=[],r=0,o=t.length;o>r;r++)n.push(e(t[r]));return n},o.isArray=function(t){return"[object Array]"===o.toString(t)},o.isString=function(t){return"[object String]"===o.toString(t)},o.isObject=function(t){return"[object Object]"===o.toString(t)},o.toString=function(t){return Object.prototype.toString.call(t)},o.each=function(t,e){for(var n=0,r=t.length;r>n;n++)e(t[n],n)},o.isUndefined=function(t){return void 0===t},o.trim=function(t){return t.replace(/(^\s+)|\s+$/g,"")},o.extend=function(t){for(var e=arguments,n=t===!0?2:1,i=arguments[n-1],a=e.length;a>n;n++){var c=e[n];for(var s in c)c.hasOwnProperty(s)&&(r(i[s],c[s])?o.extend(i[s],c[s]):i[s]=c[s])}return i},o.update=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(r(t[n],e[n])?o.update(t[n],e[n]):t[n]=e[n]);return t},o.of=function(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])},o.startsWith=function(t,e,n){return n=n||0,t.indexOf(e,n)===n},o.slice=function(t){var e=Array.prototype.slice.call(arguments,1);return Array.prototype.slice.apply(t,e)},o.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){o["is"+t]=function(e){return Object.prototype.toString.call(e)==="[object "+t+"]"}}),o.error=function(t){throw new Error(t)},o.nextTick=function(t,e){e=e||0,setTimeout(t,e)}},{}]},{},[16]);