!function t(e,n,r){function o(a,c){if(!n[a]){if(!e[a]){var s="function"==typeof require&&require;if(!c&&s)return s(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){var n=e[a][1][t];return o(n?n:t)},u,u.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,n){(function(t){(function(){function r(t,e){function n(t){if(n[t]!==m)return n[t];var r;if("bug-string-char-index"==t)r="a"!="a"[0];else if("json"==t)r=n("json-stringify")&&n("json-parse");else{var i,c='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var s=e.stringify,f="function"==typeof s&&y;if(f){(i=function(){return 1}).toJSON=i;try{f="0"===s(0)&&"0"===s(new o)&&'""'==s(new a)&&s(b)===m&&s(m)===m&&s()===m&&"1"===s(i)&&"[1]"==s([i])&&"[null]"==s([m])&&"null"==s(null)&&"[null,null,null]"==s([m,b,null])&&s({a:[i,!0,!1,null,"\x00\b\n\f\r	"]})==c&&"1"===s(null,i)&&"[\n 1,\n 2\n]"==s([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==s(new u(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==s(new u(864e13))&&'"-000001-01-01T00:00:00.000Z"'==s(new u(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==s(new u(-1))}catch(l){f=!1}}r=f}if("json-parse"==t){var p=e.parse;if("function"==typeof p)try{if(0===p("0")&&!p(!1)){i=p(c);var h=5==i.a.length&&1===i.a[0];if(h){try{h=!p('"	"')}catch(l){}if(h)try{h=1!==p("01")}catch(l){}if(h)try{h=1!==p("1.")}catch(l){}}}}catch(l){h=!1}r=h}}return n[t]=!!r}t||(t=c.Object()),e||(e=c.Object());var o=t.Number||c.Number,a=t.String||c.String,s=t.Object||c.Object,u=t.Date||c.Date,f=t.SyntaxError||c.SyntaxError,l=t.TypeError||c.TypeError,p=t.Math||c.Math,h=t.JSON||c.JSON;"object"==typeof h&&h&&(e.stringify=h.stringify,e.parse=h.parse);var d,v,m,g=s.prototype,b=g.toString,y=new u(-0xc782b5b800cec);try{y=-109252==y.getUTCFullYear()&&0===y.getUTCMonth()&&1===y.getUTCDate()&&10==y.getUTCHours()&&37==y.getUTCMinutes()&&6==y.getUTCSeconds()&&708==y.getUTCMilliseconds()}catch(w){}if(!n("json")){var x="[object Function]",j="[object Date]",S="[object Number]",O="[object String]",C="[object Array]",P="[object Boolean]",T=n("bug-string-char-index");if(!y)var k=p.floor,A=[0,31,59,90,120,151,181,212,243,273,304,334],N=function(t,e){return A[e]+365*(t-1970)+k((t-1969+(e=+(e>1)))/4)-k((t-1901+e)/100)+k((t-1601+e)/400)};if((d=g.hasOwnProperty)||(d=function(t){var e,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=b?d=function(t){var e=this.__proto__,n=t in(this.__proto__=null,this);return this.__proto__=e,n}:(e=n.constructor,d=function(t){var n=(this.constructor||e).prototype;return t in this&&!(t in n&&this[t]===n[t])}),n=null,d.call(this,t)}),v=function(t,e){var n,r,o,a=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,r=new n;for(o in r)d.call(r,o)&&a++;return n=r=null,a?v=2==a?function(t,e){var n,r={},o=b.call(t)==x;for(n in t)o&&"prototype"==n||d.call(r,n)||!(r[n]=1)||!d.call(t,n)||e(n)}:function(t,e){var n,r,o=b.call(t)==x;for(n in t)o&&"prototype"==n||!d.call(t,n)||(r="constructor"===n)||e(n);(r||d.call(t,n="constructor"))&&e(n)}:(r=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],v=function(t,e){var n,o,a=b.call(t)==x,c=!a&&"function"!=typeof t.constructor&&i[typeof t.hasOwnProperty]&&t.hasOwnProperty||d;for(n in t)a&&"prototype"==n||!c.call(t,n)||e(n);for(o=r.length;n=r[--o];c.call(t,n)&&e(n));}),v(t,e)},!n("json-stringify")){var E={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},$="000000",_=function(t,e){return($+(e||0)).slice(-t)},U="\\u00",F=function(t){for(var e='"',n=0,r=t.length,o=!T||r>10,i=o&&(T?t.split(""):t);r>n;n++){var a=t.charCodeAt(n);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=E[a];break;default:if(32>a){e+=U+_(2,a.toString(16));break}e+=o?i[n]:t.charAt(n)}}return e+'"'},R=function(t,e,n,r,o,i,a){var c,s,u,f,p,h,g,y,w,x,T,A,E,$,U,M;try{c=e[t]}catch(D){}if("object"==typeof c&&c)if(s=b.call(c),s!=j||d.call(c,"toJSON"))"function"==typeof c.toJSON&&(s!=S&&s!=O&&s!=C||d.call(c,"toJSON"))&&(c=c.toJSON(t));else if(c>-1/0&&1/0>c){if(N){for(p=k(c/864e5),u=k(p/365.2425)+1970-1;N(u+1,0)<=p;u++);for(f=k((p-N(u,0))/30.42);N(u,f+1)<=p;f++);p=1+p-N(u,f),h=(c%864e5+864e5)%864e5,g=k(h/36e5)%24,y=k(h/6e4)%60,w=k(h/1e3)%60,x=h%1e3}else u=c.getUTCFullYear(),f=c.getUTCMonth(),p=c.getUTCDate(),g=c.getUTCHours(),y=c.getUTCMinutes(),w=c.getUTCSeconds(),x=c.getUTCMilliseconds();c=(0>=u||u>=1e4?(0>u?"-":"+")+_(6,0>u?-u:u):_(4,u))+"-"+_(2,f+1)+"-"+_(2,p)+"T"+_(2,g)+":"+_(2,y)+":"+_(2,w)+"."+_(3,x)+"Z"}else c=null;if(n&&(c=n.call(e,t,c)),null===c)return"null";if(s=b.call(c),s==P)return""+c;if(s==S)return c>-1/0&&1/0>c?""+c:"null";if(s==O)return F(""+c);if("object"==typeof c){for($=a.length;$--;)if(a[$]===c)throw l();if(a.push(c),T=[],U=i,i+=o,s==C){for(E=0,$=c.length;$>E;E++)A=R(E,c,n,r,o,i,a),T.push(A===m?"null":A);M=T.length?o?"[\n"+i+T.join(",\n"+i)+"\n"+U+"]":"["+T.join(",")+"]":"[]"}else v(r||c,function(t){var e=R(t,c,n,r,o,i,a);e!==m&&T.push(F(t)+":"+(o?" ":"")+e)}),M=T.length?o?"{\n"+i+T.join(",\n"+i)+"\n"+U+"}":"{"+T.join(",")+"}":"{}";return a.pop(),M}};e.stringify=function(t,e,n){var r,o,a,c;if(i[typeof e]&&e)if((c=b.call(e))==x)o=e;else if(c==C){a={};for(var s,u=0,f=e.length;f>u;s=e[u++],c=b.call(s),(c==O||c==S)&&(a[s]=1));}if(n)if((c=b.call(n))==S){if((n-=n%1)>0)for(r="",n>10&&(n=10);r.length<n;r+=" ");}else c==O&&(r=n.length<=10?n:n.slice(0,10));return R("",(s={},s[""]=t,s),o,a,r,"",[])}}if(!n("json-parse")){var M,D,J=a.fromCharCode,B={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},I=function(){throw M=D=null,f()},L=function(){for(var t,e,n,r,o,i=D,a=i.length;a>M;)switch(o=i.charCodeAt(M)){case 9:case 10:case 13:case 32:M++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=T?i.charAt(M):i[M],M++,t;case 34:for(t="@",M++;a>M;)if(o=i.charCodeAt(M),32>o)I();else if(92==o)switch(o=i.charCodeAt(++M)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=B[o],M++;break;case 117:for(e=++M,n=M+4;n>M;M++)o=i.charCodeAt(M),o>=48&&57>=o||o>=97&&102>=o||o>=65&&70>=o||I();t+=J("0x"+i.slice(e,M));break;default:I()}else{if(34==o)break;for(o=i.charCodeAt(M),e=M;o>=32&&92!=o&&34!=o;)o=i.charCodeAt(++M);t+=i.slice(e,M)}if(34==i.charCodeAt(M))return M++,t;I();default:if(e=M,45==o&&(r=!0,o=i.charCodeAt(++M)),o>=48&&57>=o){for(48==o&&(o=i.charCodeAt(M+1),o>=48&&57>=o)&&I(),r=!1;a>M&&(o=i.charCodeAt(M),o>=48&&57>=o);M++);if(46==i.charCodeAt(M)){for(n=++M;a>n&&(o=i.charCodeAt(n),o>=48&&57>=o);n++);n==M&&I(),M=n}if(o=i.charCodeAt(M),101==o||69==o){for(o=i.charCodeAt(++M),(43==o||45==o)&&M++,n=M;a>n&&(o=i.charCodeAt(n),o>=48&&57>=o);n++);n==M&&I(),M=n}return+i.slice(e,M)}if(r&&I(),"true"==i.slice(M,M+4))return M+=4,!0;if("false"==i.slice(M,M+5))return M+=5,!1;if("null"==i.slice(M,M+4))return M+=4,null;I()}return"$"},H=function(t){var e,n;if("$"==t&&I(),"string"==typeof t){if("@"==(T?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];t=L(),"]"!=t;n||(n=!0))n&&(","==t?(t=L(),"]"==t&&I()):I()),","==t&&I(),e.push(H(t));return e}if("{"==t){for(e={};t=L(),"}"!=t;n||(n=!0))n&&(","==t?(t=L(),"}"==t&&I()):I()),(","==t||"string"!=typeof t||"@"!=(T?t.charAt(0):t[0])||":"!=L())&&I(),e[t.slice(1)]=H(L());return e}I()}return t},V=function(t,e,n){var r=Z(t,e,n);r===m?delete t[e]:t[e]=r},Z=function(t,e,n){var r,o=t[e];if("object"==typeof o&&o)if(b.call(o)==C)for(r=o.length;r--;)V(o,r,n);else v(o,function(t){V(o,t,n)});return n.call(t,e,o)};e.parse=function(t,e){var n,r;return M=0,D=""+t,n=H(L()),"$"!=L()&&I(),M=D=null,e&&b.call(e)==x?Z((r={},r[""]=n,r),"",e):n}}}return e.runInContext=r,e}var o="function"==typeof define&&define.amd,i={"function":!0,object:!0},a=i[typeof n]&&n&&!n.nodeType&&n,c=i[typeof window]&&window||this,s=a&&i[typeof e]&&e&&!e.nodeType&&"object"==typeof t&&t;if(!s||s.global!==s&&s.window!==s&&s.self!==s||(c=s),a&&!o)r(c,a);else{var u=c.JSON,f=c.JSON3,l=!1,p=r(c,c.JSON3={noConflict:function(){return l||(l=!0,c.JSON=u,c.JSON3=f,u=f=null),p}});c.JSON={parse:p.parse,stringify:p.stringify}}o&&define(function(){return p})}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){function r(t,e,n){s.each(t,function(t){s.each(t.paths,function(t){e.scope.watch(t,n)})})}function o(t){if(s.isString(t))return u.parseTokensAndPaths(t);var e="";for(key in t)e+=t[key];return u.parseTokensAndPaths(e)}function i(t){var e=new RegExp("^"+c.directivePrefix+"-([\\w\\d]+)"),n=t.name.match(e);return n?n[1]:void 0}function a(t){for(var e=["component"],n=0,r=e.length;r>n;n++)if(e[n]===t)return!0;return!1}var c=t("./config"),s=t("./util"),u=t("./parser"),f=t("./directives");n.bindText=function(t,e){function n(){var n=o;s.each(i,function(t){var r=u.exec(t,e.scope);n=n.replace(t.rawExp,r)}),t.nodeValue?t.nodeValue=n:t.textNode=n}var o=t.textContent||t.nodeValue,i=u.parse(o);n(),r(i,e,n)},n.bindDir=function(t,e,n){var r=i(t);if(r){if(!f[r])throw new Error("Directive `"+r+"` is not found.");var c=u.parseDirective(t.value),l=o(c).paths,p=f[r];p.bind(e,t,n,c),a(r)||s.each(l,function(r){n.scope.watch(r,function(){p.update(e,t,n,c)})})}},n.getTokensAndPathsFromDirective=o},{"./config":6,"./directives":9,"./parser":19,"./util":21}],3:[function(t,e,n){n.components={}},{}],4:[function(t,e,n){function r(t,e){if(1===t.nodeType){if(o(t,e),c(t).attr(u+"-repeat"))return;i.each(t.childNodes,function(t){r(t,e)})}else 3===t.nodeType&&a.bindText(t,e)}function o(t,e){var n=t.attributes;i.each(n,function(n){a.bindDir(n,t,e)})}var i=t("./util"),a=(t("./obserable"),t("./binder")),c=t("./dom"),s=t("./config"),u=s.directivePrefix;n.compile=r},{"./binder":2,"./config":6,"./dom":13,"./obserable":17,"./util":21}],5:[function(t,e,n){var r=t("./util"),o=t("./compiler"),i=(t("./object-path"),t("./parser"),t("./dom")),a=(t("./event-emitter"),t("./scope")),c=t("./common"),s=c.components,u={init:function(t,e,n){e=e||r.extend(!0,{},f),this.el=i.getDOMNodeFromTemplate(n.template),this.state=t.state;var c=e.parent.scope;this.scope=new a(e.currentPath,this.state,c),this.scope.extra=e.extra||{},o.compile(this.el,this)},update:function(t){this.scope.update(t)}},f={currentPath:"",parent:{scope:{$root:null,currentPath:""}}};c.component=e.exports=function(t,e){var e=arguments.length>=2?e:t,n=function(t,n){this.init(t,n,e)},o=n.prototype;return r.extend(o,u),r.isString(t)&&t.length>0&&(s[t]=n),n}},{"./common":3,"./compiler":4,"./dom":13,"./event-emitter":14,"./object-path":16,"./parser":19,"./scope":20,"./util":21}],6:[function(t,e,n){var r=n;r.openTag="{",r.closeTag="}",r.directivePrefix="w"},{}],7:[function(t,e,n){var r=t("../dom"),o=t("../parser");e.exports={bind:function(t,e,n,r){this.update(t,e,n,r)},update:function(t,e,n,i){var a=r(t);for(var c in i){var s=o.parseTokensAndPaths(i[c]),u=o.exec({exp:i[c],tokens:s.tokens,paths:s.paths},n.scope);u?a.addClass(c):a.removeClass(c)}}}},{"../dom":13,"../parser":19}],8:[function(t,e,n){var r=t("../util"),o=t("../object-path"),i=t("../common").components;e.exports={bind:function(t,e,n,a){var c=e.value.split(":"),s=r.trim(c[0]),u=r.trim(c[1]);i[s]||r.error("Component `"+s+"` is not found.");var f=i[s],l=n.scope.getObjectByPath(u),p=new f({state:l},{parent:n,currentPath:o.join([n.scope.currentPath,u])});r.nextTick(function(){t.innerHTML="",t.appendChild(p.el)})}}},{"../common":3,"../object-path":16,"../util":21}],9:[function(t,e,n){t("../dom");n.show=t("./show"),n.model=t("./model"),n["class"]=t("./class"),n.component=t("./component"),n.repeat=t("./repeat")},{"../dom":13,"./class":7,"./component":8,"./model":10,"./repeat":11,"./show":12}],10:[function(t,e,n){var r=t("../dom"),o=t("../object-path"),i={};i.text={bind:function(t,e,n,i){function a(){var e=i.replace(/\(\)/g,""),r=o.makeObjectByPath(e,t.value);n.scope.update(r)}this.update(t,e,n,i),r(t).on("input",a),r(t).on("keyup",a)},update:function(t,e,n,r){var i=r.replace(/\(\)/g,""),a=o.makePathFromRawPath(i),c=n.scope.getObjectByPath(a);c!==t.value&&(t.value=c)}},i.checkbox={bind:function(t,e,n,o){var i=r(t);this.update(t,e,n,o),i.on("click",function(){var e=o.replace(/\(\)/g,"");if(t.checked)var r=!0;else var r=!1;var i={};i[e]=r,n.scope.update(i)})},update:function(t,e,n,o){var i=o.replace(/\(\)/g,""),a=r(t);n.scope.state[i]?a.attr("checked","checked"):a.removeAttr("checked")}},e.exports={bind:function(t,e,n,o){var a=r(t).attr("type")||"text";"textarea"===a&&(a="text"),i[a].bind(t,e,n,o)},update:function(t,e,n,o){var a=r(t).attr("type")||"text";"textarea"===a&&(a="text"),i[a].update(t,e,n,o)}}},{"../dom":13,"../object-path":16}],11:[function(t,e,n){function r(t){var e=i.ele("div");return e.appendChild(t),e.innerHTML}var o=t("../util"),i=t("../dom"),a=t("../common"),c=(a.components,t("../object-path"));e.exports={bind:function(t,e,n,s){o.nextTick(function(){var u=document.createComment("repeat "+s),f=i(t);f.before(u),f.remove(),f.removeAttr(e.name);var l=i.frag(),p=r(t),h=a.component({template:p}),d=n.scope.getObjectByPath(s);o.each(d,function(t,e){var r=new h({state:t},{currentPath:c.join([s,e]),parent:n,extra:{$index:e}});l.appendChild(r.el)}),i(u).before(l)})},update:function(t,e,n,r){console.log(r)}}},{"../common":3,"../dom":13,"../object-path":16,"../util":21}],12:[function(t,e,n){var r=t("../dom");e.exports={bind:function(t,e,n){this.update(t,e,n)},update:function(t,e,n){var o=n.scope.state[e.value];r(t).css("display",o?"block":"none")}}},{"../dom":13}],13:[function(t,e,n){var r=t("./util"),o=function(t){return{el:t,attr:function(t,e){return 1===arguments.length?this.el.getAttribute(t):void this.el.setAttribute(t,e)},removeAttr:function(t){this.el.removeAttribute(t)},css:function(t,e){1===arguments.length?this.el.style[t]:this.el.style[t]=e},on:function(t,e){var n=this.el;return n.addEventListener?n.addEventListener(t,e,!1):n.attachEvent?n.attachEvent("on"+t,e):n[t]=e,this},addClass:function(t){var e=new RegExp("(^|\\s)"+t+"(\\s|$)"),n=r.trim(this.el.className);if(!e.test(n)){var o=0===this.el.className.length?"":" ";this.el.className+=o+t}return this},removeClass:function(t){var e=this.el.className,n=new RegExp("(^|\\s)"+t+"(\\s|$)");this.el.className=r.trim(e.replace(n,"$1"))},html:function(t){return 0===arguments.length?this.el.innerHTML:void(this.el.innerHTML=t)},remove:function(){return this.el.parentNode.removeChild(this.el),this},before:function(t){return this.el.parentNode.insertBefore(t,this.el),this}}};o.getDOMNodeFromTemplate=function(t){var e=document.createElement("div");return e.innerHTML=t,e.children[0]},o.frag=function(){return document.createDocumentFragment()},o.ele=function(t){return document.createElement(t)},e.exports=o},{"./util":21}],14:[function(t,e,n){function r(){this.events={}}var o=t("./util"),i=r.prototype;i.on=function(t,e){this.events[t]?this.events[t].push(e):this.events[t]=[e]},i.emit=function(t){var e=this.events[t];if(e){var n=[].slice.call(arguments,1);o.each(e,function(t){t.apply(t,n)})}},i.off=function(t,e){var n=this.events[t];if(n)for(var r=0,o=n.length;o>r;r++)n[r]===e&&(n.splice(r,1),0===n.length&&delete this.events[t])},e.exports=r},{"./util":21}],15:[function(t,e,n){function r(t){}r.component=t("./component"),r.render=function(t,e){t.innerHTML="",t.appendChild(e.el)},t("./page-test")(r)},{"./component":5,"./page-test":18}],16:[function(t,e,n){var r=t("./util");n.getFirstProp=function(t){var e=/(^[\w_\$][\w\$_]+)([\.\[\]])?/;return t.match(e)[1]},n.makePathFromRawPath=function(t){var e=/(\[)|(\](\.)?)/g;return t.replace(e,".").replace(/\.$/,"")},n.makeStepsFromPath=function(t){var e=t.split("."),n=e[0],o=[n];return r.each(e,function(t,e){0!=e&&(n+="."+t,o.push(n))}),o},n.makePathsOfObj=function(t){function e(t,i,a){var c=n.join([a,t]);r.isObject(i)?r.of(i,function(t,n){e(t,n,c)}):o.push(c)}var o=[];return r.of(t,e),o},n.join=function(t){var e="";return r.each(t,function(t,n){r.isUndefined(t)||r.isString(t)&&0===t.length||(e=0===e.length?t:e+("."+t))}),e},n.getObjectByPath=function(t,e){var n=e.split("."),o=t;return r.each(n,function(t){o=o[t]}),o},n.makeObjectByPath=function(t,e){var n={},o=n,i=t.split("."),a=i.length-1;return r.each(i,function(t,n){n!==a?o=o[t]={}:o[t]=e}),n}},{"./util":21}],17:[function(t,e,n){function r(t){function e(t){return 0===arguments.length?n.value:(n.oldValue=this.value,n.value=t,void n.notify())}var n=this;return this.value=t,this.watchers=[],e.$$=n,e}function o(t){}function i(t){return a.isArray(t)?new o(t):new r(t)}var a=t("./util.js");r.prototype.notify=function(){var t=this;a.each(this.watchers,function(e){e(t.value,t.oldValue,t)})},r.prototype.watch=function(t){this.watchers.push(t)},i.ObserableKey=r,i.ObserableArray=o,e.exports=i},{"./util.js":21}],18:[function(t,e,n){var r=t("./dom");window.JSON=t("json3"),e.exports=function(t){var e=r(document.getElementById("user-tpl")).html(),n=r(document.getElementById("profile-tpl")).html(),o=r(document.getElementById("school-tpl")).html(),i={_id:0,education:{school:"No!",date:"2015-07-09"},profile:{school:{name:"SYSU",isShow:!1},name:"jerry",desc:"I love you!",girls:[{name:"lucy",age:18},{name:"Lily",age:19},{name:"Jessy",age:20}],avatars:["/pics/1","/pics/2"]}},a=(t.component("Profile",{template:n}),t.component("User",{template:e})),c=(t.component("School",{template:o}),new a({state:i}));console.log(c),t.render(document.getElementById("content"),c),window.u=function(t){c.update({_id:"fuck",education:{school:"HuaGong"},profile:{girls:{0:{name:"Fuck Lucy!"},1:{name:"Fuck Lily!"}}}}),c.updateArray("profil.girls").slice(0,1)}}},{"./dom":13,json3:1}],19:[function(t,e,n){function r(){i=u.openTag.replace(p,"\\$1"),a=u.closeTag.replace(p,"\\$1"),c=new RegExp(i+"[\\S\\s]+?"+a,"g"),s=new RegExp(i+"|"+a,"g")}function o(t){var e=/["']/g;return t.replace(e,"")}var i,a,c,s,u=t("./config"),f=t("./util"),l=t("./object-path"),p=/(\*\.\?\+\$\^\[\]\(\)\{\}\|\\\/)/g;n.getRawExps=function(t){var e=t.match(c)||[];return e},n.getExpFromRawExp=function(t){return t.replace(s,"")};var h=/[_\w\$][_\$\w\d\.\[\]]+/g,d="Math,Date,this,true,false,null,undefined,Infinity,NaN,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,parseInt,parseFloat,in,JSON",v=new RegExp("^("+d.replace(/,/g,"\\b|")+"\\b)");n.parse=function(t){r();var e=n.getRawExps(t),o=[];return f.each(e,function(t){var e=n.getExpFromRawExp(t),r=n.parseTokensAndPaths(e),i={rawExp:t,exp:e,tokens:r.tokens,paths:r.paths};o.push(i)}),o},n.parseTokensAndPaths=function(t){var e=/('[\s\S]*?')|("[\s\S]*?")/g;t=t.replace(e,"");var n=t.match(h)||[],r={},o={},i=[],a=[];f.each(n,function(t){c=l.getFirstProp(t),v.test(c)||(r[c]=1,o[t]=1)});for(var c in r)i.push(c);for(var s in o)a.push(l.makePathFromRawPath(s));return{tokens:i,paths:a}},n.exec=function(t,e){var n=[],r=t.tokens;f.each(r,function(t){n.push(e.get(t))});var o="return "+t.exp+";";return new Function(r,o).apply(e,n)},n.parseDirective=function(t){var e=/^[_$\w][_$\w\d\s\(\)\.\[\]]*$/,t=f.trim(t);if(0===t.length||e.test(t))return l.makePathFromRawPath(t);var n={};return f.each(t.split(","),function(t){var e=t.split(":"),r=o(f.trim(e[0])),i=f.trim(e[1]);n[r]=i}),n},r()},{"./config":6,"./object-path":16,"./util":21}],20:[function(t,e,n){function r(t,e,n){a.call(this),n&&n.$root?(this.$root=n.$root,n.subScopes.push(this)):this.$root=this,this.currentPath=t,this.state=e,this.watchPaths=this.events,this.subScopes=[]}function o(t,e){return i.startsWith(e,t)}var i=t("./util"),a=t("./event-emitter"),c=t("./object-path"),s=i.extend(r.prototype,a.prototype);s.update=function(t){var e=this,n=c.makePathsOfObj(t);i.update(this.state,t),i.each(n,function(t){var n=c.join([e.currentPath,t]);e.$root.deliverChange(n)})},s.deliverChange=function(t){o(this.currentPath,t)&&(this.emitCurrentWatchers(t),this.deliverChangeToSubScopes(t))},s.emitCurrentWatchers=function(t){var e=this.watchPaths;for(var n in e)o(n,t)&&this.emit(n)},s.watch=function(t,e){var n=c.join([this.currentPath,t]);this.on(n,e)},s.removeSubScope=function(t){for(var e=this.subScopes,n=0,r=e;r>n;n++)if(e[n]===t)return e.splice(n,1)},s.deliverChangeToSubScopes=function(t){i.each(this.subScopes,function(e){o(e.currentPath,t)&&e.deliverChange(t)})},s.get=function(t){return this.state[t]||this.extra[t]||""},s.getObjectByPath=function(t){return c.getObjectByPath(this.state,t)},e.exports=r},{"./event-emitter":14,"./object-path":16,"./util":21}],21:[function(t,e,n){function r(t,e){return!i.isUndefined(t)&&(i.isObject(t)||i.isArray(t))&&!i.isUndefined(e)&&i.isObject(e)}var o=t("./obserable"),i=n;i.isObserable=function(t){var t=t.$$;return t instanceof o.ObserableKey||t instanceof o.ObserableArray},i.map=function(t,e){for(var n=[],r=0,o=t.length;o>r;r++)n.push(e(t[r]));return n},i.isArray=function(t){return"[object Array]"===i.toString(t)},i.isString=function(t){return"[object String]"===i.toString(t)},i.isObject=function(t){return"[object Object]"===i.toString(t)},i.toString=function(t){return Object.prototype.toString.call(t)},i.each=function(t,e){for(var n=0,r=t.length;r>n;n++)e(t[n],n)},i.isUndefined=function(t){return void 0===t},i.trim=function(t){return t.replace(/(^\s+)|\s+$/g,"")},i.extend=function(t){for(var e=arguments,n=t===!0?2:1,o=arguments[n-1],a=e.length;a>n;n++){var c=e[n];for(var s in c)c.hasOwnProperty(s)&&(r(o[s],c[s])?i.extend(o[s],c[s]):o[s]=c[s])}return o},i.update=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(r(t[n],e[n])?i.update(t[n],e[n]):t[n]=e[n]);return t},i.of=function(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])},i.startsWith=function(t,e,n){return n=n||0,t.indexOf(e,n)===n},i.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){i["is"+t]=function(e){return Object.prototype.toString.call(e)==="[object "+t+"]"}}),i.error=function(t){throw new Error(t)},i.nextTick=function(t,e){e=e||0,setTimeout(t,e)}},{"./obserable":17}]},{},[15]);