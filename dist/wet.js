!function t(e,n,r){function o(i,c){if(!n[i]){if(!e[i]){var s="function"==typeof require&&require;if(!c&&s)return s(i,!0);if(a)return a(i,!0);throw new Error("Cannot find module '"+i+"'")}var u=n[i]={exports:{}};e[i][0].call(u.exports,function(t){var n=e[i][1][t];return o(n?n:t)},u,u.exports,t,e,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(t,e,n){(function(t){(function(){function r(t,e){function n(t){if(n[t]!==m)return n[t];var r;if("bug-string-char-index"==t)r="a"!="a"[0];else if("json"==t)r=n("json-stringify")&&n("json-parse");else{var a,c='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var s=e.stringify,f="function"==typeof s&&b;if(f){(a=function(){return 1}).toJSON=a;try{f="0"===s(0)&&"0"===s(new o)&&'""'==s(new i)&&s(y)===m&&s(m)===m&&s()===m&&"1"===s(a)&&"[1]"==s([a])&&"[null]"==s([m])&&"null"==s(null)&&"[null,null,null]"==s([m,y,null])&&s({a:[a,!0,!1,null,"\x00\b\n\f\r	"]})==c&&"1"===s(null,a)&&"[\n 1,\n 2\n]"==s([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==s(new u(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==s(new u(864e13))&&'"-000001-01-01T00:00:00.000Z"'==s(new u(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==s(new u(-1))}catch(l){f=!1}}r=f}if("json-parse"==t){var p=e.parse;if("function"==typeof p)try{if(0===p("0")&&!p(!1)){a=p(c);var h=5==a.a.length&&1===a.a[0];if(h){try{h=!p('"	"')}catch(l){}if(h)try{h=1!==p("01")}catch(l){}if(h)try{h=1!==p("1.")}catch(l){}}}}catch(l){h=!1}r=h}}return n[t]=!!r}t||(t=c.Object()),e||(e=c.Object());var o=t.Number||c.Number,i=t.String||c.String,s=t.Object||c.Object,u=t.Date||c.Date,f=t.SyntaxError||c.SyntaxError,l=t.TypeError||c.TypeError,p=t.Math||c.Math,h=t.JSON||c.JSON;"object"==typeof h&&h&&(e.stringify=h.stringify,e.parse=h.parse);var d,v,m,g=s.prototype,y=g.toString,b=new u(-0xc782b5b800cec);try{b=-109252==b.getUTCFullYear()&&0===b.getUTCMonth()&&1===b.getUTCDate()&&10==b.getUTCHours()&&37==b.getUTCMinutes()&&6==b.getUTCSeconds()&&708==b.getUTCMilliseconds()}catch(w){}if(!n("json")){var x="[object Function]",P="[object Date]",j="[object Number]",S="[object String]",k="[object Array]",O="[object Boolean]",A=n("bug-string-char-index");if(!b)var T=p.floor,C=[0,31,59,90,120,151,181,212,243,273,304,334],$=function(t,e){return C[e]+365*(t-1970)+T((t-1969+(e=+(e>1)))/4)-T((t-1901+e)/100)+T((t-1601+e)/400)};if((d=g.hasOwnProperty)||(d=function(t){var e,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=y?d=function(t){var e=this.__proto__,n=t in(this.__proto__=null,this);return this.__proto__=e,n}:(e=n.constructor,d=function(t){var n=(this.constructor||e).prototype;return t in this&&!(t in n&&this[t]===n[t])}),n=null,d.call(this,t)}),v=function(t,e){var n,r,o,i=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,r=new n;for(o in r)d.call(r,o)&&i++;return n=r=null,i?v=2==i?function(t,e){var n,r={},o=y.call(t)==x;for(n in t)o&&"prototype"==n||d.call(r,n)||!(r[n]=1)||!d.call(t,n)||e(n)}:function(t,e){var n,r,o=y.call(t)==x;for(n in t)o&&"prototype"==n||!d.call(t,n)||(r="constructor"===n)||e(n);(r||d.call(t,n="constructor"))&&e(n)}:(r=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],v=function(t,e){var n,o,i=y.call(t)==x,c=!i&&"function"!=typeof t.constructor&&a[typeof t.hasOwnProperty]&&t.hasOwnProperty||d;for(n in t)i&&"prototype"==n||!c.call(t,n)||e(n);for(o=r.length;n=r[--o];c.call(t,n)&&e(n));}),v(t,e)},!n("json-stringify")){var E={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},N="000000",F=function(t,e){return(N+(e||0)).slice(-t)},R="\\u00",U=function(t){for(var e='"',n=0,r=t.length,o=!A||r>10,a=o&&(A?t.split(""):t);r>n;n++){var i=t.charCodeAt(n);switch(i){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=E[i];break;default:if(32>i){e+=R+F(2,i.toString(16));break}e+=o?a[n]:t.charAt(n)}}return e+'"'},_=function(t,e,n,r,o,a,i){var c,s,u,f,p,h,g,b,w,x,A,C,E,N,R,B;try{c=e[t]}catch(J){}if("object"==typeof c&&c)if(s=y.call(c),s!=P||d.call(c,"toJSON"))"function"==typeof c.toJSON&&(s!=j&&s!=S&&s!=k||d.call(c,"toJSON"))&&(c=c.toJSON(t));else if(c>-1/0&&1/0>c){if($){for(p=T(c/864e5),u=T(p/365.2425)+1970-1;$(u+1,0)<=p;u++);for(f=T((p-$(u,0))/30.42);$(u,f+1)<=p;f++);p=1+p-$(u,f),h=(c%864e5+864e5)%864e5,g=T(h/36e5)%24,b=T(h/6e4)%60,w=T(h/1e3)%60,x=h%1e3}else u=c.getUTCFullYear(),f=c.getUTCMonth(),p=c.getUTCDate(),g=c.getUTCHours(),b=c.getUTCMinutes(),w=c.getUTCSeconds(),x=c.getUTCMilliseconds();c=(0>=u||u>=1e4?(0>u?"-":"+")+F(6,0>u?-u:u):F(4,u))+"-"+F(2,f+1)+"-"+F(2,p)+"T"+F(2,g)+":"+F(2,b)+":"+F(2,w)+"."+F(3,x)+"Z"}else c=null;if(n&&(c=n.call(e,t,c)),null===c)return"null";if(s=y.call(c),s==O)return""+c;if(s==j)return c>-1/0&&1/0>c?""+c:"null";if(s==S)return U(""+c);if("object"==typeof c){for(N=i.length;N--;)if(i[N]===c)throw l();if(i.push(c),A=[],R=a,a+=o,s==k){for(E=0,N=c.length;N>E;E++)C=_(E,c,n,r,o,a,i),A.push(C===m?"null":C);B=A.length?o?"[\n"+a+A.join(",\n"+a)+"\n"+R+"]":"["+A.join(",")+"]":"[]"}else v(r||c,function(t){var e=_(t,c,n,r,o,a,i);e!==m&&A.push(U(t)+":"+(o?" ":"")+e)}),B=A.length?o?"{\n"+a+A.join(",\n"+a)+"\n"+R+"}":"{"+A.join(",")+"}":"{}";return i.pop(),B}};e.stringify=function(t,e,n){var r,o,i,c;if(a[typeof e]&&e)if((c=y.call(e))==x)o=e;else if(c==k){i={};for(var s,u=0,f=e.length;f>u;s=e[u++],c=y.call(s),(c==S||c==j)&&(i[s]=1));}if(n)if((c=y.call(n))==j){if((n-=n%1)>0)for(r="",n>10&&(n=10);r.length<n;r+=" ");}else c==S&&(r=n.length<=10?n:n.slice(0,10));return _("",(s={},s[""]=t,s),o,i,r,"",[])}}if(!n("json-parse")){var B,J,M=i.fromCharCode,D={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},I=function(){throw B=J=null,f()},L=function(){for(var t,e,n,r,o,a=J,i=a.length;i>B;)switch(o=a.charCodeAt(B)){case 9:case 10:case 13:case 32:B++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=A?a.charAt(B):a[B],B++,t;case 34:for(t="@",B++;i>B;)if(o=a.charCodeAt(B),32>o)I();else if(92==o)switch(o=a.charCodeAt(++B)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=D[o],B++;break;case 117:for(e=++B,n=B+4;n>B;B++)o=a.charCodeAt(B),o>=48&&57>=o||o>=97&&102>=o||o>=65&&70>=o||I();t+=M("0x"+a.slice(e,B));break;default:I()}else{if(34==o)break;for(o=a.charCodeAt(B),e=B;o>=32&&92!=o&&34!=o;)o=a.charCodeAt(++B);t+=a.slice(e,B)}if(34==a.charCodeAt(B))return B++,t;I();default:if(e=B,45==o&&(r=!0,o=a.charCodeAt(++B)),o>=48&&57>=o){for(48==o&&(o=a.charCodeAt(B+1),o>=48&&57>=o)&&I(),r=!1;i>B&&(o=a.charCodeAt(B),o>=48&&57>=o);B++);if(46==a.charCodeAt(B)){for(n=++B;i>n&&(o=a.charCodeAt(n),o>=48&&57>=o);n++);n==B&&I(),B=n}if(o=a.charCodeAt(B),101==o||69==o){for(o=a.charCodeAt(++B),(43==o||45==o)&&B++,n=B;i>n&&(o=a.charCodeAt(n),o>=48&&57>=o);n++);n==B&&I(),B=n}return+a.slice(e,B)}if(r&&I(),"true"==a.slice(B,B+4))return B+=4,!0;if("false"==a.slice(B,B+5))return B+=5,!1;if("null"==a.slice(B,B+4))return B+=4,null;I()}return"$"},H=function(t){var e,n;if("$"==t&&I(),"string"==typeof t){if("@"==(A?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];t=L(),"]"!=t;n||(n=!0))n&&(","==t?(t=L(),"]"==t&&I()):I()),","==t&&I(),e.push(H(t));return e}if("{"==t){for(e={};t=L(),"}"!=t;n||(n=!0))n&&(","==t?(t=L(),"}"==t&&I()):I()),(","==t||"string"!=typeof t||"@"!=(A?t.charAt(0):t[0])||":"!=L())&&I(),e[t.slice(1)]=H(L());return e}I()}return t},W=function(t,e,n){var r=V(t,e,n);r===m?delete t[e]:t[e]=r},V=function(t,e,n){var r,o=t[e];if("object"==typeof o&&o)if(y.call(o)==k)for(r=o.length;r--;)W(o,r,n);else v(o,function(t){W(o,t,n)});return n.call(t,e,o)};e.parse=function(t,e){var n,r;return B=0,J=""+t,n=H(L()),"$"!=L()&&I(),B=J=null,e&&y.call(e)==x?V((r={},r[""]=n,r),"",e):n}}}return e.runInContext=r,e}var o="function"==typeof define&&define.amd,a={"function":!0,object:!0},i=a[typeof n]&&n&&!n.nodeType&&n,c=a[typeof window]&&window||this,s=i&&a[typeof e]&&e&&!e.nodeType&&"object"==typeof t&&t;if(!s||s.global!==s&&s.window!==s&&s.self!==s||(c=s),i&&!o)r(c,i);else{var u=c.JSON,f=c.JSON3,l=!1,p=r(c,c.JSON3={noConflict:function(){return l||(l=!0,c.JSON=u,c.JSON3=f,u=f=null),p}});c.JSON={parse:p.parse,stringify:p.stringify}}o&&define(function(){return p})}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){function r(t,e,n){this.arr=t,this.scope=n,this.path=e}var o=t("./object-path"),a=t("./util"),i=r.prototype;a.each(["replace","pop","push","shift","unshift","splice","sort","reverse"],function(t){i[t]=function(){var e=this.arr[t].apply(this.arr,arguments);return this.scope.broadcast(o.makeArrayEvent(t,this.path),arguments),e}}),e.exports=r},{"./object-path":18,"./util":23}],3:[function(t,e,n){function r(t,e,n){s.each(t,function(t){s.each(t.paths,function(t){e.scope.watch(t,n)})})}function o(t){if(s.isString(t))return u.parseTokensAndPaths(t);var e="";for(key in t)e+=t[key];return u.parseTokensAndPaths(e)}function a(t){var e=new RegExp("^"+c.directivePrefix+"-([\\w\\d]+)"),n=t.name.match(e);return n?n[1]:void 0}function i(t){for(var e=["component","repeat","on"],n=0,r=e.length;r>n;n++)if(e[n]===t)return!0;return!1}var c=t("./config"),s=t("./util"),u=t("./parser"),f=t("./directives");n.bindText=function(t,e){function n(){var n=o;s.each(a,function(t){var r=u.exec(t,e.scope);n=n.replace(t.rawExp,r)}),t.nodeValue?t.nodeValue=n:t.textNode=n}var o=t.textContent||t.nodeValue,a=u.parse(o);n(),r(a,e,n)},n.bindDir=function(t,e,n){var r=a(t);if(r){if(!f[r])throw new Error("directive `"+r+"` is not found.");var c=u.parseDirective(t.value),l=o(c).paths,p=f[r];p.bind(e,t,n,c),i(r)||s.each(l,function(r){n.scope.watch(r,function(){p.update(e,t,n,c)})})}},n.getTokensAndPathsFromDirective=o},{"./config":7,"./directives":10,"./parser":21,"./util":23}],4:[function(t,e,n){n.components={}},{}],5:[function(t,e,n){function r(t,e){if(1===t.nodeType){if(o(t,e),c(t).attr(u+"-repeat"))return;a.each(t.childNodes,function(t){r(t,e)})}else 3===t.nodeType&&i.bindText(t,e)}function o(t,e){var n=t.attributes;a.each(n,function(n){i.bindDir(n,t,e)})}var a=t("./util"),i=(t("./obserable"),t("./binder")),c=t("./dom"),s=t("./config"),u=s.directivePrefix;n.compile=r},{"./binder":3,"./config":7,"./dom":15,"./obserable":19,"./util":23}],6:[function(t,e,n){var r=t("./util"),o=t("./compiler"),a=(t("./object-path"),t("./parser"),t("./dom")),i=(t("./event-emitter"),t("./scope")),c=t("./common"),s=c.components,u={init:function(t,e,n){e=e||r.extend(!0,{},f),this.el=a.getDOMNodeFromTemplate(n.template),this.state=t.state;var c=e.parent.scope;this.scope=new i(e.currentPath,this.state,c),this.scope.extra=e.extra||{},this.scope.extra.$this=this,o.compile(this.el,this),r.extend(this,t)},update:function(t){this.scope.update(t)},updateArray:function(){return this.scope.updateArray.apply(this.scope,arguments)}},f={currentPath:"",parent:{scope:{$root:null,currentPath:""}}};c.component=e.exports=function(t,e){var e=arguments.length>=2?e:t,n=function(t,n){this.init(t,n,e)},o=n.prototype;return r.extend(o,u),r.isString(t)&&t.length>0&&(s[t]=n),r.of(e,function(t,e){r.isFunction(e)&&(o[t]=e)}),n}},{"./common":4,"./compiler":5,"./dom":15,"./event-emitter":16,"./object-path":18,"./parser":21,"./scope":22,"./util":23}],7:[function(t,e,n){var r=n;r.openTag="{",r.closeTag="}",r.directivePrefix="w",r.arrayEventPrefix="$$array$$"},{}],8:[function(t,e,n){var r=t("../dom"),o=t("../parser");e.exports={bind:function(t,e,n,r){this.update(t,e,n,r)},update:function(t,e,n,a){var i=r(t);for(var c in a){var s=o.parseTokensAndPaths(a[c]),u=o.exec({exp:a[c],tokens:s.tokens,paths:s.paths},n.scope);u?i.addClass(c):i.removeClass(c)}}}},{"../dom":15,"../parser":21}],9:[function(t,e,n){var r=t("../util"),o=t("../object-path"),a=t("../common").components;e.exports={bind:function(t,e,n,i){function c(){}var s=e.value.split(":"),u=r.trim(s[0]),f=s[1]?r.trim(s[1]):"$item";a[u]||r.error("Component `"+u+"` is not found.");var l=a[u],p=n.scope.getObjectByPath(f),h="$item"===f?"":f;c.prototype=n.constructor.prototype;var d=new c;r.extend(d,l.prototype),l.prototype=d;var v=new l({state:p},{parent:n,currentPath:o.join([n.scope.currentPath,h])});r.nextTick(function(){t.innerHTML="",t.appendChild(v.el)})}}},{"../common":4,"../object-path":18,"../util":23}],10:[function(t,e,n){t("../dom");n.show=t("./show"),n.model=t("./model"),n["class"]=t("./class"),n.component=t("./component"),n.repeat=t("./repeat"),n.on=t("./on")},{"../dom":15,"./class":8,"./component":9,"./model":11,"./on":12,"./repeat":13,"./show":14}],11:[function(t,e,n){var r=t("../dom"),o=t("../object-path"),a={};a.text={bind:function(t,e,n,a){function i(){var e=a.replace(/\(\)/g,""),r=o.makePathFromRawPath(e),i=o.makeObjectByPath(r,t.value),c=o.getFirstProp(r),s=n.scope.getRightScopeByToken(c);s.update(i)}this.update(t,e,n,a),r(t).on("input",i),r(t).on("keyup",i)},update:function(t,e,n,r){var a=r.replace(/\(\)/g,""),i=o.makePathFromRawPath(a),c=o.getFirstProp(i),s=n.scope.getRightScopeByToken(c),u=s.getObjectByPath(i);u!==t.value&&(t.value=u)}},a.checkbox={bind:function(t,e,n,o){var a=r(t);this.update(t,e,n,o),a.on("click",function(){var e=o.replace(/\(\)/g,"");if(t.checked)var r=!0;else var r=!1;var a={};a[e]=r,n.scope.update(a)})},update:function(t,e,n,o){var a=o.replace(/\(\)/g,""),i=r(t);n.scope.state[a]?i.attr("checked","checked"):i.removeAttr("checked")}},e.exports={bind:function(t,e,n,o){var i=r(t).attr("type")||"text";"textarea"===i&&(i="text"),a[i].bind(t,e,n,o)},update:function(t,e,n,o){var i=r(t).attr("type")||"text";"textarea"===i&&(i="text"),a[i].update(t,e,n,o)}}},{"../dom":15,"../object-path":18}],12:[function(t,e,n){function r(t,e,n){if(0===t.length)return[n];var r=[];return a.each(t,function(t){r.push("$event"===t?n:e.scope.getObjectByPath(a.trim(t)))}),r}var o=t("../dom"),a=t("../util");e.exports={bind:function(t,e,n,a){var i=/([\S\s]+)(\([\S\s]+\))/,c=o(t);for(var s in a){var u=a[s].match(i),f=[];if(u){var l=u[1];u[2]&&(f=u[2].replace(/[\(\)]/g,"").split(","))}else var l=a[s];!function(t,e,o){c.on(e,function(e){var a=r(t,n,e);n[o].apply(n,a)})}(f,s,l)}}}},{"../dom":15,"../util":23}],13:[function(t,e,n){function r(t,e,n,r,o){function c(){}var u=f(t),p=document.createComment("repeat "+r+" "+o),h=document.createComment("repeat "+r+" end "+o);u.before(p),u.before(h),u.remove(),u.removeAttr(e.name);var d=i(t),v=l.component({template:d});c.prototype=n.constructor.prototype,v.prototype=new c;var m=a(t,n,r,v,h),g=[p,h];return s(n,o,{Component:v,holders:g,components:m}),g}function o(t,e,n,r,o,i){var s=n.scope,l=n.scope.getScopeAndWatchPath(e.value).watchPath;s.watchArray(l,function(e,r){function l(){for(;v!==m;){var e=v.nextSibling;f(v).remove(),v=e}u.each(h.components,function(t){n.scope.removeSubScope(t.scope)});var r=a(t,n,i,h.Component,h.holders[1]);h.components=r}var h=c(n,o),d=h.holders[0],v=d.nextSibling,m=h.holders[1];switch(e){case"pop":if(m.previousSibling!==d){f(m.previousSibling).remove();var g=h.components.pop();s.removeSubScope(g.scope)}break;case"push":u.each(r,function(t,e){var r=h.components.length,o=p.join([n.scope.currentPath,i,r]),a=new h.Component({state:t},{currentPath:o,parent:n,extra:{$index:r,$item:t}});h.components.push(a),f(m).before(a.el)});break;default:l()}})}function a(t,e,n,r,o){var a=f.frag(),i=e.scope.getObjectByPath(n),c=[];return u.each(i,function(t,o){var i=new r({state:t},{currentPath:p.join([e.scope.currentPath,n,o]),parent:e,extra:{$index:o,$item:t}});c.push(i),a.appendChild(i.el)}),f(o).before(a),c}function i(t){var e=f.ele("div");return e.appendChild(t),e.innerHTML}function c(t,e){return t.scope.$root.repeatCache[e]}function s(t,e,n){var r=t.scope.$root;r.repeatCache||(r.repeatCache=[]),r.repeatCache[e]=n}var u=t("../util"),f=t("../dom"),l=t("../common"),p=(l.components,t("../object-path")),h=0;e.exports={bind:function(t,e,n,a){u.nextTick(function(){!function(i){var c=r(t,e,n,a,i);o(t,e,n,c,i,a)}(h++)})}}},{"../common":4,"../dom":15,"../object-path":18,"../util":23}],14:[function(t,e,n){var r=t("../dom");e.exports={bind:function(t,e,n){this.update(t,e,n)},update:function(t,e,n){var o=n.scope.state[e.value];r(t).css("display",o?"block":"none")}}},{"../dom":15}],15:[function(t,e,n){var r=t("./util"),o=function(t){return{el:t,attr:function(t,e){return 1===arguments.length?this.el.getAttribute(t):void this.el.setAttribute(t,e)},removeAttr:function(t){this.el.removeAttribute(t)},css:function(t,e){1===arguments.length?this.el.style[t]:this.el.style[t]=e},on:function(t,e){var n=this.el;return n.addEventListener?n.addEventListener(t,e,!1):n.attachEvent?n.attachEvent("on"+t,e):n[t]=e,this},addClass:function(t){var e=new RegExp("(^|\\s)"+t+"(\\s|$)"),n=r.trim(this.el.className);if(!e.test(n)){var o=0===this.el.className.length?"":" ";this.el.className+=o+t}return this},removeClass:function(t){var e=this.el.className,n=new RegExp("(^|\\s)"+t+"(\\s|$)");this.el.className=r.trim(e.replace(n,"$1"))},html:function(t){return 0===arguments.length?this.el.innerHTML:void(this.el.innerHTML=t)},remove:function(t){if(!this.el.parentNode&&t){var e=this;r.nextTick(function(){e.remove(t)})}else this.el.parentNode.removeChild(this.el);return this},before:function(t,e){if(!this.el.parentNode&&e){var n=this;r.nextTick(function(){n.before(t,e)})}else this.el.parentNode.insertBefore(t,this.el);return this}}};o.getDOMNodeFromTemplate=function(t){var e=document.createElement("div");return e.innerHTML=t,e.children[0]},o.frag=function(){return document.createDocumentFragment()},o.ele=function(t){return document.createElement(t)},e.exports=o},{"./util":23}],16:[function(t,e,n){function r(){this.events={}}var o=t("./util"),a=r.prototype;a.on=function(t,e){this.events[t]?this.events[t].push(e):this.events[t]=[e]},a.emit=function(t){var e=this.events[t];if(e){var n=[].slice.call(arguments,1);o.each(e,function(t){t.apply(t,n)})}},a.off=function(t,e){var n=this.events[t];if(n)for(var r=0,o=n.length;o>r;r++)n[r]===e&&(n.splice(r,1),0===n.length&&delete this.events[t])},e.exports=r},{"./util":23}],17:[function(t,e,n){function r(t){}r.component=t("./component"),r.render=function(t,e){t.innerHTML="",t.appendChild(e.el)},t("./page-test")(r)},{"./component":6,"./page-test":20}],18:[function(t,e,n){var r=t("./util"),o=t("./config");n.getFirstProp=function(t){var e=/(^[\w_\$][\w\$_]+)([\.\[\]])?/;return t.match(e)[1]},n.makePathFromRawPath=function(t){var e=/(\[)|(\](\.)?)/g;return t.replace(e,".").replace(/\.$/,"")},n.makeStepsFromPath=function(t){var e=t.split("."),n=e[0],o=[n];return r.each(e,function(t,e){0!=e&&(n+="."+t,o.push(n))}),o},n.makePathsOfObj=function(t){function e(t,a,i){var c=n.join([i,t]);r.isObject(a)?r.of(a,function(t,n){e(t,n,c)}):o.push(c)}var o=[];return r.of(t,e),o},n.join=function(t){var e="";return r.each(t,function(t,n){r.isUndefined(t)||r.isString(t)&&0===t.length||(e=0===e.length?t:e+("."+t))}),e},n.getObjectByPath=function(t,e){var n=e.split("."),o=t;return r.each(n,function(t){o=o[t]}),o},n.makeObjectByPath=function(t,e){var o={},a=o;t=n.makePathFromRawPath(t);var i=t.split("."),c=i.length-1;return r.each(i,function(t,n){n!==c?a=a[t]={}:a[t]=e}),o},n.makeArrayEvent=function(t,e){return o.arrayEventPrefix+":"+t+":"+e}},{"./config":7,"./util":23}],19:[function(t,e,n){function r(t){function e(t){return 0===arguments.length?n.value:(n.oldValue=this.value,n.value=t,void n.notify())}var n=this;return this.value=t,this.watchers=[],e.$$=n,e}function o(t){}function a(t){return i.isArray(t)?new o(t):new r(t)}var i=t("./util.js");r.prototype.notify=function(){var t=this;i.each(this.watchers,function(e){e(t.value,t.oldValue,t)})},r.prototype.watch=function(t){this.watchers.push(t)},a.ObserableKey=r,a.ObserableArray=o,e.exports=a},{"./util.js":23}],20:[function(t,e,n){var r=t("./dom");window.JSON=t("json3"),e.exports=function(t){var e=r(document.getElementById("user-tpl")).html(),n=r(document.getElementById("profile-tpl")).html(),o=r(document.getElementById("school-tpl")).html(),a=r(document.getElementById("girl-tpl")).html(),i={_id:0,costs:[1,2,3,4,5,6],education:{school:"No!",date:"2015-07-09"},profile:{school:{name:"SYSU",isShow:!1},name:"jerry",desc:"I love you!",girls:[{name:"lucy",age:18},{name:"Lily",age:19},{name:"Jessy",age:20}],avatars:["/pics/1","/pics/2"]}},c=(t.component("Profile",{template:n}),t.component("User",{template:e,tellMom:function(){console.log("good",arguments)}})),s=(t.component("School",{template:o}),t.component("Girl",{template:a,clickOnName:function(t){console.log(this.state.name,t)}}),new c({state:i}));t.render(document.getElementById("content"),s),console.log(s),window.u=function(t){s.update({_id:"fuck",education:{school:"HuaGong"},profile:{girls:{0:{name:"Fuck Lucy!"},1:{name:"Fuck Lily!"}}}})},window.u2=function(t){s.update({profile:{girls:[{name:"Tomy",age:49},{name:"Jerry",age:48},{name:"Jack",age:55}]}})},window.u3=function(){console.log("pop"),s.updateArray("profile.girls").pop()},window.splice=function(){console.log("pop"),s.updateArray("profile.girls").splice(1,1)},window.reverse=function(){console.log("pop"),s.updateArray("profile.girls").reverse(),s.updateArray("costs").reverse()},window.u4=function(){console.log("shift"),s.updateArray("profile.girls").shift()},window.sort=function(){s.updateArray("costs").sort(function(t,e){return e-t})},window.u5=function(){console.log("push"),s.updateArray("profile.girls").push({name:"Mike",age:45},{name:"John",age:34})},window.u6=function(){console.log("unshift"),s.updateArray("profile.girls").unshift({name:"Mike",age:45},{name:"John",age:34})},window.m=i}},{"./dom":15,json3:1}],21:[function(t,e,n){function r(){a=u.openTag.replace(p,"\\$1"),i=u.closeTag.replace(p,"\\$1"),c=new RegExp(a+"[\\S\\s]+?"+i,"g"),s=new RegExp(a+"|"+i,"g")}function o(t){var e=/["']/g;return t.replace(e,"")}var a,i,c,s,u=t("./config"),f=t("./util"),l=t("./object-path"),p=/(\*\.\?\+\$\^\[\]\(\)\{\}\|\\\/)/g;n.getRawExps=function(t){var e=t.match(c)||[];return e},n.getExpFromRawExp=function(t){return t.replace(s,"")};var h=/[_\w\$][_\$\w\d\.\[\]]+/g,d="Math,Date,this,true,false,null,undefined,Infinity,NaN,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,parseInt,parseFloat,in,JSON",v=new RegExp("^("+d.replace(/,/g,"\\b|")+"\\b)");n.parse=function(t){r();var e=n.getRawExps(t),o=[];return f.each(e,function(t){var e=n.getExpFromRawExp(t),r=n.parseTokensAndPaths(e),a={rawExp:t,exp:e,tokens:r.tokens,paths:r.paths};o.push(a)}),o},n.parseTokensAndPaths=function(t){var e=/('[\s\S]*?')|("[\s\S]*?")/g;t=t.replace(e,"");var n=t.match(h)||[],r={},o={},a=[],i=[];f.each(n,function(t){c=l.getFirstProp(t),v.test(c)||(r[c]=1,o[t]=1)});for(var c in r)a.push(c);for(var s in o)i.push(l.makePathFromRawPath(s));return{tokens:a,paths:i}},n.exec=function(t,e){var n=[],r=t.tokens;f.each(r,function(t){n.push(e.get(t))});var o="return "+t.exp+";";return new Function(r,o).apply(e,n)},n.parseDirective=function(t){function e(){a[f.trim(o(r))]=f.trim(c),r="",c=""}var n=/^[_$\w][_$\w\d\s\(\)\.\[\]]*$/,t=f.trim(t);if(0===t.length||n.test(t))return l.makePathFromRawPath(t);var r,a={},i=0,c="",s=t.split("");return f.each(s,function(t){switch(i){case 0:c+=t,i=1;break;case 1:":"===t?(r=c,c="",i=2):c+=t;break;case 2:","===t?(e(),i=1):"("===t?(c+=t,i=3):c+=t;break;case 3:c+=t,")"===t&&(i=4);break;case 4:","===t&&(e(),i=1)}}),e(),a},r()},{"./config":7,"./object-path":18,"./util":23}],22:[function(t,e,n){function r(t,e,n){this.currentPath=t,this.state=e,this.watchPaths={},this.subScopes=[],this.parentScope=n,n&&n.$root&&t?(this.$root=n.$root,n.subScopes.push(this)):(this.$root=this,this.emitter=new i)}function o(t){return a.startsWith(t,s.arrayEventPrefix)}var a=t("./util"),i=t("./event-emitter"),c=t("./object-path"),s=t("./config"),u=t("./array-factory"),f=r.prototype;f.update=function(t){var e=this,n=c.makePathsOfObj(t);a.update(this.state,t),a.each(n,function(t){var n=e.getObjectByPath(t),r=c.join([e.currentPath,t]);a.isArray(n)&&(r=s.arrayEventPrefix+":replace:"+r),e.$root.broadcast(r)})},f.updateArray=function(t){var e=this.getObjectByPath(t);return a.isArray(e)||a.error(t+" is not an array"),new u(e,t,this)},f.watchArray=function(t,e){var n=this.getObjectByPath(t);a.isArray(n)||a.error(t+" is not an array");var r=["replace","pop","push","shift","unshift","splice","sort","reverse"],o=this;a.each(r,function(n){var r=c.makeArrayEvent(n,t),a=function(){[].unshift.call(arguments,n),e.apply(e,arguments)};o.$root.emitter.on(r,a),o.addLocalWatchPath(r,a)})},f.broadcast=function(t,e){if(!this.emitter)return a.error("I am not a root!");if(o(t)){this.$root.emitter.emit(t,e);var n=t.split(":")[2];for(var r in this.emitter.events)a.startsWith(r,n)&&r.length>n.length&&this.emitter.emit(r,e);t=n}var i=c.makeStepsFromPath(t),s=this;a.each(i,function(t){s.$root.emitter.emit(t,e)})},f.watch=function(t,e){var n=this.getScopeAndWatchPath(t),r=n.watchPath;this.addLocalWatchPath(t,e),this.$root.emitter.on(r,e)},f.addLocalWatchPath=function(t,e){var n=this.watchPaths[t];n?n.push(e):this.watchPaths[t]=[e]},f.getScopeAndWatchPath=function(t){t=c.makePathFromRawPath(t);var e=c.getFirstProp(t),n=this.getRightScopeByToken(e),r=c.join([n.currentPath,t]);return{scope:n,watchPath:r}},f.getRightScopeByToken=function(t){for(var e=this,n=!1;""!=e.currentPath&&a.isUndefined(e.state[t])&&a.isUndefined(e.extra[t]);)e=e.parentScope,n=!0;return n?e:this},f.removeSubScope=function(t){for(var e=this.subScopes,n=0,r=e.length;r>n;n++)if(e[n]===t)return t.unwatch(),e.splice(n,1)},f.unwatch=function(){var t=this.watchPaths,e=this.$root,n=this;for(var r in t)a.each(t[r],function(t){var o=c.join([n.currentPath,r]);e.emitter.off(o,t)});a.each(this.subScopes,function(t){t.unwatch()})},f.get=function(t){var e=this.getRightScopeByToken(t),n=e.state[t]||e.extra[t];return a.isUndefined(n)?"":n},f.getObjectByPath=function(t){t=c.makePathFromRawPath(t);var e=c.getFirstProp(t),n=this.getRightScopeByToken(e),r=c.getObjectByPath(n.state,t);return a.isUndefined(r)?c.getObjectByPath(n.extra,t):r},e.exports=r},{"./array-factory":2,"./config":7,"./event-emitter":16,"./object-path":18,"./util":23}],23:[function(t,e,n){function r(t,e){return!a.isUndefined(t)&&(a.isObject(t)||a.isArray(t))&&!a.isUndefined(e)&&a.isObject(e)}var o=t("./obserable"),a=n;a.isObserable=function(t){var t=t.$$;return t instanceof o.ObserableKey||t instanceof o.ObserableArray},a.map=function(t,e){for(var n=[],r=0,o=t.length;o>r;r++)n.push(e(t[r]));return n},a.isArray=function(t){return"[object Array]"===a.toString(t)},a.isString=function(t){return"[object String]"===a.toString(t)},a.isObject=function(t){return"[object Object]"===a.toString(t)},a.toString=function(t){return Object.prototype.toString.call(t)},a.each=function(t,e){for(var n=0,r=t.length;r>n;n++)e(t[n],n)},a.isUndefined=function(t){return void 0===t},a.trim=function(t){return t.replace(/(^\s+)|\s+$/g,"")},a.extend=function(t){for(var e=arguments,n=t===!0?2:1,o=arguments[n-1],i=e.length;i>n;n++){var c=e[n];for(var s in c)c.hasOwnProperty(s)&&(r(o[s],c[s])?a.extend(o[s],c[s]):o[s]=c[s])}return o},a.update=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(r(t[n],e[n])?a.update(t[n],e[n]):t[n]=e[n]);return t},a.of=function(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])},a.startsWith=function(t,e,n){return n=n||0,t.indexOf(e,n)===n},a.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){a["is"+t]=function(e){return Object.prototype.toString.call(e)==="[object "+t+"]"}}),a.error=function(t){throw new Error(t)},a.nextTick=function(t,e){e=e||0,setTimeout(t,e)}},{"./obserable":19}]},{},[17]);